# Vulnerability Classification & Jira Ticket Automation

This tool automates the classification of security vulnerabilities using Google Gemini AI and creates corresponding Jira tickets for tracking and remediation.

---

## Features

- **Multi-line Input**: Enter multiple vulnerabilities at once (one per line).
- **AI-Powered Classification**: Classify each vulnerability as `Low`, `Medium`, or `Critical` with a brief description.
- **Role Assignment**: Automatically determine the appropriate assignee role (e.g., front-end, back-end, UI, AI, Flutter).
- **Jira Integration**: Create Jira tickets with the correct project, issue type, priority, labels, and assignee.
- **Configurable**: Easily adjust Gemini model, Jira project settings, and user mappings.

---

## Prerequisites

1. **Python 3.8+**  
2. **Required Python Packages**  
   ```bash
   pip install google-genai jira termcolor
   ```

---

## Configuration

Set the following environment variables before running the tool:

| Variable          | Description                                    |
|-------------------|------------------------------------------------|
| `GEMINI_API_KEY`  | Google Gemini API key                          |
| `JIRA_URL`        | Your Jira instance URL (e.g., `https://your.atlassian.net`) |
| `JIRA_USER`       | Jira user email                                |
| `JIRA_TOKEN`      | Jira API token generated from your account     |
| `JIRA_PROJECT`    | Short key for your Jira project (e.g., `SEC`)  |

You can also modify the corresponding constants at the top of the script.

---

## Usage

1. **Run the Script**  
   ```bash
   python3 vulnerability_jira.py
   ```

2. **Enter Vulnerabilities**  
   Paste or type vulnerabilities, one per line. Press Enter twice to finish.

3. **Review Classification**  
   The tool will display AI-generated classifications and descriptions.

4. **Confirm Ticket Creation**  
   When prompted, confirm whether to create Jira tickets.

---

## Example

```text
Enter vulnerabilities (one per line). Press Enter twice to finish:
1. SQL injection in user login endpoint
2. Cross-site scripting in comment form

Classifying vulnerabilities...
Classification Results:
1. Sql injection in user login endpoint [CRITICAL]
2. Cross-site scripting in comment form [MEDIUM]

Create Jira tickets for these vulnerabilities? (Y/N): Y

Connecting to Jira...
Creating tickets in project SEC...
  Created SEC-101 - CRITICAL (back-end)
  Created SEC-102 - MEDIUM (ui)

Successfully created 2 Jira tickets:
- https://your.atlassian.net/browse/SEC-101
- https://your.atlassian.net/browse/SEC-102
```

---

## Customization

- **Model Settings**: Change `model="gemini-2.0-flash"` or other parameters in `client.models.generate_content`.
- **Assignee Mapping**: Update `assignee_map` in `create_jira_tickets` with your account IDs.
- **Issue Type**: Adjust `issue_type` or add custom fields as needed.

---

## Troubleshooting

- **Authentication Errors**: Verify `JIRA_USER`, `JIRA_TOKEN`, and `JIRA_URL`.
- **API Quotas**: Ensure your Gemini API key has sufficient quota.
- **Timeouts**: Increase Jira client timeout in `JIRA(..., options={'timeout': 30})`.

---

## License

MIT License. See [LICENSE](LICENSE) for details.
